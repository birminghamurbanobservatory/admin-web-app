<div class="container container--padded-top container--padded-bottom">

  <div fxLayout="row" fxLayoutAlign="center">
    <a [routerLink]="['./create']" mat-raised-button color="accent">Create new platform</a>
  </div>

  <br><br><br>

  <h2>Platforms</h2>

  <form [formGroup]="optionsForm">
    <mat-slide-toggle formControlName="nest">Nest</mat-slide-toggle>
  </form>

  <div *ngIf="platforms.length > 0">
    <mat-paginator 
      [length]="meta.total"
      [pageSize]="limit"
      [pageIndex]="calculatePageIndex()"
      [pageSizeOptions]="limitOptions"
      [showFirstLastButtons]="true"
      (page)="pageEvent($event)"
    >
    </mat-paginator>
  </div>

  <div *ngIf="state === 'getting'" fxLayout="column" fxLayoutAlign="center center">
    <mat-spinner></mat-spinner>
    <p>Getting Platforms</p>
  </div>

  <div *ngIf="state === 'failed'">
    <p class="text--warn">{{getErrorMessage}}</p>
  </div>  

  <div *ngIf="state === 'got'">

    <div *ngIf="platforms.length > 0">
      <!-- TODO: Could provide various different view options here, e.g. the standard list view, or a map view, or a tree view.  -->

      <mat-accordion>
        <mat-expansion-panel *ngFor="let platform of platforms">
          <mat-expansion-panel-header [ngStyle]="setExpansionPanelHeaderStyle(platform.depth)">
            <mat-panel-title>
              <strong>
                <span>{{'-'.repeat(platform.depth)}}</span>
                {{platform.name}}
              </strong>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <uo-platform [platform]="platform" (deleted)="onDeleted($event)"></uo-platform>
          
        </mat-expansion-panel>
      </mat-accordion>
    </div>

    <div *ngIf="platforms.length === 0" fxLayout="row" fxLayoutAlign="center">
      <p>You don't appear to have any platforms yet</p>
    </div>

  </div>


  
</div>



